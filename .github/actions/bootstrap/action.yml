name: 'Bootstrap pkgsrc'
description: 'Bootstrap pkgsrc prefix'
inputs:
  platform:
    required: true
  hash:
    required: true
runs:
  using: composite
  steps:
    - name: Check for cached bootstrap kit
      id: bootstrap-kit
      uses: actions/cache@v4
      with:
        key: bootstrap-kit-${{ inputs.platform }}-${{ inputs.hash }}
        path: ~/bootstrap.tar

    - name: Bootstrap if required
      if: steps.bootstrap-kit.outputs.cache-hit != 'true'
      shell: bash
      run: ./.github/scripts/bootstrap.sh

    - name: Share bootstrap artifact
      uses: actions/upload-artifact@v4
      with:
        name: bootstrap-kit-${{ inputs.platform }}
        path: ~/bootstrap.tar
